# ========================================
# COMPATIBILIDAD COMPLETA PARA DOCKER
# (Recrea TODAS las cadenas iptables-nft que Docker necesita)
# ========================================

table ip filter {

    # Docker exige que FORWARD exista y sea policy ACCEPT
    chain FORWARD {
        type filter hook forward priority filter; policy accept;
    }

    # Estas cadenas deben existir aunque vac√≠as
    chain DOCKER {
    }

    chain DOCKER-USER {
        return;
    }

    chain DOCKER-FORWARD {
    }

    chain DOCKER-BRIDGE {
    }

    chain DOCKER-CT {
    }

    chain DOCKER-INTERNAL {
    }
}

table ip nat {
    chain DOCKER {
    }

    chain PREROUTING {
        type nat hook prerouting priority dstnat; policy accept;
    }

    chain OUTPUT {
        type nat hook output priority dstnat; policy accept;
    }

    chain POSTROUTING {
        type nat hook postrouting priority srcnat; policy accept;
    }
}

table ip raw {
    chain PREROUTING {
        type filter hook prerouting priority raw; policy accept;
    }
}
